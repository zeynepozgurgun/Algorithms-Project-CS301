# -*- coding: utf-8 -*-
"""heuristic_time_complexity.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1CgadXAfr3kr0i6FVh67RbJFCTjXoFtYu
"""

import numpy as np
from sklearn.linear_model import LinearRegression
import matplotlib.pyplot as plt

data = {
    2: [3, 2, 3, 2, 4, 2, 2, 2, 2, 2, 3, 3, 3, 3, 2, 2, 3, 2, 4, 2],
    3: [3, 5, 4, 3, 11, 5, 6, 5, 3, 5, 3, 5, 3, 4, 4, 5, 4, 3, 3, 3],
    4: [21, 13, 4, 22, 22, 13, 27, 16, 15, 4, 6, 28, 20, 13, 16, 12, 22, 9, 4, 4],
    5: [6, 23, 24, 24, 4, 42, 34, 34, 46, 24, 24, 6, 42, 64, 36, 35, 45, 4, 25, 36],
    6: [46, 39, 51, 38, 39, 38, 38, 38, 37, 37, 37, 38, 37, 37, 64, 39, 38, 37, 37],
    7: [73, 67, 63, 64, 62, 64, 74, 74, 89, 67, 63, 86, 70, 62, 63, 64, 63, 63, 63],
    8: [174, 122, 112, 113, 112, 119, 112, 110, 110, 135, 115, 115, 111, 129, 112, 111, 113, 134, 111],
    9: [295, 292, 281, 281, 292, 275, 283, 275, 285, 279, 288, 289, 278, 285, 280, 288, 277, 279, 293],
    10: [304, 249, 250, 220, 238, 276, 245, 224, 224, 251, 246, 222, 220, 226, 220, 239, 215, 227, 222],
    11: [475, 411, 421, 1329, 274, 254, 287, 277, 259, 253, 278, 318, 259, 275, 257, 253, 253, 278, 256],
    12: [521, 519, 356, 316, 300, 317, 426, 385, 298, 311, 298, 383, 413, 350, 390, 464, 455, 312, 322],
    13: [579, 552, 514, 545, 523, 526, 525, 527, 544, 599, 528, 511, 623, 767, 561, 861, 663, 654, 574],
    14: [797, 833, 726, 699, 726, 680, 693, 697, 692, 703, 679, 686, 782, 838, 703, 682, 683, 692, 691],
    15: [1007, 986, 984, 978, 958, 954, 1365, 1293, 1053, 1002, 981, 974, 1600, 1005, 980, 1006, 976, 995, 959],
    16: [1368, 1287, 1307, 1300, 1300, 1293, 1304, 1311, 1321, 1318, 1374, 1601, 1394, 1647, 1283, 1285, 1351, 1314, 1347],
    17: [1494, 1324, 1717, 1371, 1401, 1662, 1662, 1456, 1314, 1294, 1462, 1311, 1295, 1290, 1309, 1251, 1281, 1300, 1459],
    18: [2090, 1868, 2206, 2896, 2863, 2866, 2862, 2873, 2830, 2916, 2863, 2906, 2718, 1911, 1842, 1825, 1951, 1822, 1820],
    19: [2191, 2262, 2172, 2152, 2104, 2109, 2110, 2314, 2159, 2164, 2119, 2162, 2262, 2249, 2207, 2157, 2121, 2137, 2121],
    20: [2932, 2841, 2769, 2766, 2735, 2790, 3568, 3034, 2799, 2758, 2737, 2749, 2751, 2808, 2747, 2729, 3333, 3284, 2781],
    21: [9290, 5683, 5165, 5227, 7211, 9296, 5223, 5496, 5697, 6041, 5432, 5775, 5215, 5255, 5292, 5348, 5585, 6384, 6711, 11766],
    22: [ 4845, 6790, 5028, 8115, 7344, 7239, 7369, 7126, 7165, 5333, 4640, 4919, 4290, 4325, 4851, 4319, 4495, 4300, 4344, 4283],
    23: [ 8072, 8009, 8056, 8041, 8023, 8035, 7999, 7981, 6516, 4724, 4759, 5002, 4795, 5189, 5098, 4741, 5015, 4726, 4728, 4747],
    24: [ 4996, 4696, 4643, 4815, 4769, 5024, 4617, 4643, 4652, 4727, 4794, 4688, 4607, 4992, 4870, 4646, 5799, 5704, 4816, 4713],
    25: [ 10402, 11379, 11017, 7835, 9927, 53711, 12451, 14437, 13515, 50630, 7424, 9874, 10222, 10043, 10368, 58847, 10630, 8565, 10509, 61245],
    26: [ 12108, 12157, 12138, 12085, 10841, 7162, 7142, 7561, 7028, 7546, 9914, 7517, 9819, 10710, 11546, 9095, 8891, 7827, 7801, 25180],
    27: [ 11081, 11993, 10672, 48789, 13872, 13419, 12916, 10123, 9077, 8032, 22935, 14001, 13532, 13625, 13459, 13566, 9310, 8197, 8176, 8272],
    28: [ 13652, 86122, 14722, 85931, 14522, 16513, 80434, 16572, 82638, 15997, 82054, 15177, 83099, 17229, 80143, 15408, 15352, 76166, 13331, 13428],
    29: [ 167539, 29621, 75489, 21706, 16586, 81709, 18678, 71075, 16899, 64496, 20154, 19431, 64713, 16034, 17410, 65976, 17099, 16691, 64724, 17791],
    30: [ 20130, 19586, 63004, 21546, 62680, 17556, 22374, 59680, 19831, 24101, 62329, 19086, 17611, 56521, 25809, 15637, 10993, 62717, 16468, 15647],
    31: [ 21383, 85619, 90023, 92251, 26307, 94902, 85578, 23813, 109579, 78347, 86303, 18190, 86972, 18139, 87748, 18926, 72558, 18283, 19028, 71730],
    32: [ 36481, 71415, 45961, 80760, 26452, 69696, 27072, 97816, 62543, 61725, 41772, 27029, 63519, 33834, 64261, 141761, 55764, 102225, 87593, 27110],
    33: [ 173517, 94853, 93112, 31478, 89527, 92911, 94909, 92516, 26136, 91592, 87825, 101461, 90743, 22193, 83729, 5842, 5806, 7471, 93057, 180263],
    34: [ 32251, 78065, 80135, 31263, 81915, 79098, 32119, 82526, 86560, 97451, 28077, 93386, 91366, 95576, 94391, 29673, 91268, 94817, 83055, 32633],
    35: [ 187796, 151172, 48012, 151614, 38084, 83354, 118723, 82146, 96951, 120737, 174861, 110409, 92527, 94188, 98611, 101957, 106260, 279827, 43790, 75300],
    36: [ 77559, 86545, 93913, 40591, 89023, 81081, 35626, 81114, 76005, 61409, 128523, 102721, 111409, 123584, 83125, 91588, 15894, 12999, 66210, 20612],
    37: [ 105742, 112713, 178235, 110206, 104742, 104765, 106751, 102494, 94315, 91409, 91136, 40001, 88640, 88051, 84912, 20853, 73489, 21730, 90654, 91865],
    38: [ 93899, 95479, 98654, 93119, 95830, 97056, 98652, 95319, 99402, 98098, 44574, 93886, 94091, 99376, 90751, 85936, 36636, 88110, 78657, 91867],
    39: [ 89838, 94060, 117571, 101108, 93806, 95340, 91696, 26620, 154237, 118353, 184009, 101543, 40041, 93032, 87857, 112143, 72600, 96692, 99668, 95279],
    40: [ 81413, 103090, 95656, 98904, 99813, 104520, 104926, 96204, 95156, 97830, 102484, 14501, 13476, 75375, 20528, 67859, 19147, 20002, 64488, 13282],
    41: [ 211761, 133097, 167948, 125733, 163775, 120030, 121351, 168916, 113276, 109526, 105877, 99960, 102761, 97719, 88864, 89533, 101249, 191533, 103775, 94821],
    42: [ 111828, 182722, 200964, 202709, 205896, 198422, 191475, 189752, 103123, 104087, 113459, 105450, 185098, 180431, 110430, 18903, 87063, 20140, 78799, 19238],
    43: [ 126449, 103303, 104669, 174831, 290680, 127561, 107943, 105410, 161879, 38359, 96225, 84641, 86250, 36687, 92158, 91367, 79306, 35593, 85704, 87753],
    44: [ 170413, 117147, 192838, 286605, 200837, 220332, 301732, 86082, 90011, 38644, 97217, 108867, 80054, 171763, 41922, 182250, 192612, 82131, 105936, 102973],
    45: [ 170294, 114690, 110074, 176125, 297387, 293874, 205578, 96062, 102293, 53838, 90204, 156241, 97995, 45273, 103212, 74259, 96155, 21303, 82624, 21630],
    46: [ 270142, 177835, 136929, 199958, 179197, 135497, 264989, 199481, 109639, 123036, 166262, 127796, 269593, 33552, 79173, 76721, 31895, 33489, 48866, 13891],
    47: [ 214783, 311411, 306582, 215522, 149095, 126246, 96706, 69824, 76962, 71344, 63164, 65792, 78003, 70552, 62815, 34068, 33831, 27823, 30363, 35305],
    48: [ 273453, 222265, 133870, 89852, 102032, 125251, 236904, 221306, 176529, 285153, 106236, 101757, 99055, 101367, 104229, 62798, 63018, 62957, 65526, 31140],
    49: [ 95491, 90437, 214497, 189972, 205204, 272167, 213899, 209195, 182068, 202618, 207945, 187399, 21196, 79812, 29802, 77395, 26736, 73814, 27217, 69717],
    50: [ 136375, 100651, 99341, 92815, 97517, 96752, 92031, 93956, 99438, 93372, 105647, 96206, 102815, 89843, 91089, 57451, 62035, 64331, 60219, 57920],
    51: [ 264140, 246269, 397987, 313954, 303117, 158591, 62402, 54121, 48526, 47886, 47710, 47366, 46438, 47526, 52597, 58770, 49548, 47283, 51879, 70131],
    52: [ 547152, 399489, 426358, 478668, 299621, 208642, 8842, 8709, 8738, 66927, 8970, 8608, 8414, 8511, 64538, 9652, 9015, 5801, 7477, 68966],
    53: [ 290418, 184195, 104063, 114697, 108879, 98412, 100566, 108159, 80877, 64161, 74516, 70791, 57496, 56636, 54224, 55221, 75958, 68251, 68790, 54907],
    54: [ 289670, 238307, 131657, 137946, 134348, 120668, 150257, 144370, 122271, 128865, 134378, 62809, 63158, 63629, 65420, 78655, 98662, 91174, 156943, 207373],
    55: [ 209854, 188352, 195626, 188290, 203240, 311932, 225283, 190827, 183039, 196654, 179222, 200436, 141445, 146962, 210967, 210796, 54073, 38679, 38747, 47034],
    56: [ 491156, 794675, 1125050, 368794, 99849, 127384, 156478, 121209, 124280, 159088, 107331, 114587, 88520, 118995, 171903, 97801, 97682, 102843, 103665, 103237],
    57: [ 153952, 140322, 159638, 143867, 141124, 145608, 156667, 146745, 158560, 185097, 167020, 164422, 161979, 111476, 101103, 99813, 96426, 94868, 96706, 94931],
    58: [ 166851, 164754, 176757, 160178, 155822, 162090, 169657, 230696, 304718, 299891, 237533, 186564, 118139, 165140, 123015, 105713, 62232, 63049, 68214, 29533],
    59: [ 168900, 194541, 170156, 165712, 165997, 169978, 219895, 167775, 205144, 80299, 77276, 81941, 89934, 84823, 75508, 77907, 79568, 87146, 74026, 79083],
    60: [ 221782, 179969, 172189, 374341, 490479, 143048, 172063, 95458, 94072, 94587, 106887, 16076, 15123, 15224, 15367, 15343, 16082, 15058, 17532, 15909]
}

results = {}

for n, values in data.items():
    mean = sum(values) / len(values)
    sd = math.sqrt(sum((x - mean)**2 for x in values) / len(values))
    sm = sd / math.sqrt(n)
    M1 = mean + 2.093 * sm
    M2 = mean + 2.093 * sm
    results[n] = (M1, M2)

x_values = list(results.keys())
y_values_M1 = [result[0] for result in results.values()]

plt.figure(figsize=(15, 6))
plt.scatter(x_values, y_values_M1, label='M1')
plt.xlabel('N values')
plt.ylabel('M1 values')
plt.title('Scatter Plot of M1 values for different N values')
plt.legend()

# Fit a linear regression line to the M1 data
regression_x = np.array(x_values).reshape(-1, 1)
regression_y_M1 = np.array(y_values_M1)

regressor_M1 = LinearRegression()
regressor_M1.fit(regression_x, regression_y_M1)
regression_line_M1 = regressor_M1.predict(regression_x)
slope_M1 = regressor_M1.coef_[0]
print("Slope of the fitted line for M1:", slope_M1)

plt.plot(x_values, regression_line_M1, color='red')

plt.xticks(x_values)
plt.legend()
plt.show()